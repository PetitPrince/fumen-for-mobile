language: node_js
node_js: 8
cache: yarn
script:
  - yarn test-ci
  - yarn cypress-ci
  - yarn webpack:prod
before_deploy:
  - touch public/.nojekyll
deploy:
  - provider: pages
    skip-cleanup: true
    github-token: ${GITHUB_TOKEN}
    keep-history: true
    repo: knewjade/fumen-for-mobile-dev
    local-dir: public/
    target-branch: master
    on:
      all_branches: true
  - provider: pages
    skip-cleanup: true
    github-token: ${GITHUB_TOKEN}
    keep-history: true
    repo: knewjade/fumen-for-mobile
    local-dir: public/
    target-branch: master
    on:
      branch: master